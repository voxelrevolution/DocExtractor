# T04.4.2_JD-DEV013_BackendChatAPI

**JD used:** DEV-013 (Full Stack Developer)

**Requirement:** R04.4.1 â€“ Copilot Chat

## Objective
Implement the backend `/api/chat` endpoint used by the Copilot Chat UI, including document/corpus scope and citations.

## Acceptance Criteria
- `POST /api/chat` exists and returns `ChatResponse`.
- Supports `scope=document` and `scope=corpus`.
- Returns citations (`source`, optional `page`, optional `line`, optional `snippet`).
- Preserves in-session history (client-supplied) for local inference.
- Local-only behavior is maintained (no non-local inference).
- Tests exist and pass.

## Notes
- Prompt design and safety guardrails are tracked in dedicated tasks (AGENT-002, AGENT-007).
