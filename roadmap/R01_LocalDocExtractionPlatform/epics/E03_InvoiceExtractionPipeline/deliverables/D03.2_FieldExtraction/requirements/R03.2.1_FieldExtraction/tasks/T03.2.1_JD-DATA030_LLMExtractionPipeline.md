# Task Specification

**Task ID:** T03.2.1_JD-DATA030_LLMExtractionPipeline

---

## SECTION 1: GOVERNANCE (EMBEDDED)

#### Task Deliverable (Specification File)

| Property | Value |
|---|---|
| **File Name** | T03.2.1_JD-DATA030_LLMExtractionPipeline.md |
| **Location** | /roadmap/R01_LocalDocExtractionPlatform/epics/E03_InvoiceExtractionPipeline/deliverables/D03.2_FieldExtraction/requirements/R03.2.1_FieldExtraction/tasks/ |
| **Owner** | DATA-030 |
| **Purpose** | Task specification + acceptance criteria + DoD checklist |

#### Evidence Artifacts (Created as Task Progresses)

| Artifact Type | File Name Pattern | Location | Owner | Purpose |
|---|---|---|---|---|
| Design Document | T03.2.1_JD-DATA030_Design.md | /evidence/R03.2.1_FieldExtraction/ | DATA-030 | Extraction design |
| Implementation Notes | T03.2.1_JD-DATA030_Implementation.md | /evidence/R03.2.1_FieldExtraction/ | DATA-030 | Build notes |
| Test Results | T03.2.1_JD-DATA030_TestResults.md | /evidence/R03.2.1_FieldExtraction/ | DATA-030 | Validation evidence |
| Completion Summary | T03.2.1_JD-DATA030_CompletionSummary.md | /evidence/R03.2.1_FieldExtraction/ | DATA-030 | Delivery summary |
| Sign-Off | T03.2.1_JD-QC101_SignOff.md | /evidence/R03.2.1_FieldExtraction/ | QC-101 | External approval |

---

## SECTION 2: TASK DEFINITION

### Objective (One Sentence)
Implement schema-constrained LLM extraction for invoices with grounded evidence and JSON validity enforcement.

### Description
- Build LLM prompt template with schema-first constraints.
- Enforce JSON validity and schema validation, with bounded repair loop.
- Attach confidence/evidence metadata per field.
- Record model/prompt/version metadata for reproducibility.

### Acceptance Criteria
- LLM extraction returns schema-valid JSON or explicit error.
- Evidence pointers present for extracted fields.
- Prompt versioning and model metadata stored in output.
- Low-confidence cases flagged for review.

### Assigned JD Role
**Role:** DATA-030 â€“ Local LLM Extraction Engineer (non-delegable)

### Dependencies (Blocking This Task)
- T03.1.1 schema definition completed.

### Downstream Tasks (That This Unblocks)
- T03.5.1 validation and conflict handling
- T03.7.1 benchmark evaluation

---

## SECTION 3: ACCEPTANCE CRITERIA & DEFINITION OF DONE

Requirement: **R03.2.1**

#### DoD Checklist (8 Gates)
- [x] Gate 1: Specification Complete
- [x] Gate 2: Approach Defined
- [x] Gate 3: Implementation Complete
- [x] Gate 4: Testing Verified
- [x] Gate 5: JD Context Embedded
- [x] Gate 6: Artifacts Collected
- [x] Gate 7: Documentation Updated
- [ ] Gate 8: QC-101 Approval

---

## SECTION 4: JD CONTEXT (PRELOADED)

### Role: Local LLM Extraction Engineer (Ollama)
**Agent ID:** DATA-030

**Key Responsibilities for This Task:**
- Schema-constrained generation and JSON validity enforcement.
- Grounded extraction with evidence references.
- Stable inference settings and reproducibility.

**World-Class Behaviors Expected:**
- Return only schema-valid JSON; repair loop on failures.
- Avoid hallucination; return null when missing.
- Track model/prompt versions in outputs.

**Output Expectations:**
- LLM extraction pipeline with schema validation.
- Evidence-backed outputs and reproducibility metadata.

---

## SECTION 5: EVIDENCE COLLECTION CHECKLIST
- [x] Task spec file created
- [x] Design document created
- [x] Implementation notes captured
- [x] Test results captured
- [x] Completion summary filed
- [ ] QC-101 sign-off captured
