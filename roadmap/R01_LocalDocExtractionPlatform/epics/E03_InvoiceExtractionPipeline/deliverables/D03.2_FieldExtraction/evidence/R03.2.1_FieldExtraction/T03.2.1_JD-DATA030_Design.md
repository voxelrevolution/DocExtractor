# T03.2.1_JD-DATA030_Design

## LLM Extraction Pipeline Design
- Use schema-first prompting with `InvoiceExtraction.model_json_schema()`.
- Enforce JSON-only responses, with strict retry on failure.
- Attach extraction metadata (`engine`, `model`, `prompt_version`, `tokens_used`).
- Fall back to deterministic rules when LLM fails.

## Evidence Strategy
- Evidence pointers included per field (from schema and extraction flow).
- Line-tagged text includes page/line/source tags for grounding.
